{% extends "base.html" %}
{% block head %}
    <head>
        <meta charset="UTF-8">
        <title>测试管理系统</title>
        <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
        <link rel="stylesheet" href="../static/layui/css/layui.css">

        {#——————————————————引用CDN地址更新layui2.5版本——————————————————#}
        <link rel="stylesheet" href="https://res.layui.com/layui/dist/css/layui.css?t=1560414887305">
        <script src="https://www.layuicdn.com/layui-v2.5.4/layui.js"></script>
        <!--     <script type="text/javascript">try { Typekit.load(); } catch (e) { }</script> -->
        <script type="text/javascript" src="../static/js/tool_p.js"></script>
    </head>
{% endblock head %}
{% block left %}
    {{ super() }}
{% endblock left %}
{% block right %}
    {{ super() }}

    <!-- 修改name（页面名称） -->
    {#	{% set name = '编辑任务' %}#}
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
        <legend>{{ title }}</legend>
    </fieldset>
    <!-- 页面私有部分 -->
    <form class="layui-form" lay-filter="exam" action="{{ api }}" method="POST" style="width: 600px ;margin-top: 50px">
        <div class="layui-form-item">
            {% if title == "编辑任务" %}
                <div class="layui-form-item" style="line-height:30px">
                    <label class="layui-form-label">任务ID</label>
                    <div class="layui-input-block">
                        <input type="text" name="task_id" lay-verify="required" autocomplete="off" class="layui-input"
                               style="width: 300px" value={{ task_info[0] }} readonly unselectable="on">
                    </div>
                </div>
            {% endif %}
            <div class="layui-form-item" style="line-height:30px">
                <label class="layui-form-label">任务名称</label>
                <div class="layui-input-block">
                    <input type="text" name="task_name" lay-verify="required" autocomplete="off" placeholder="请输入任务名称"
                           class="layui-input" style="width: 300px" value={{ task_info[1] }}>
                </div>
            </div>
            <form class="layui-form" action="">
                <div class="layui-form-item">
                    <label class="layui-form-label">执行频率</label>
                    <div class="layui-input-block" style="width: 300px">
                        <select name="frequency" lay-filter="aihao" id="select">
                            <option value=""></option>
                            <option value="1">1分钟执行一次</option>
                            <option value="2">2分钟执行一次</option>
                            <option value="3">3分钟执行一次</option>
                            <option value="5">5分钟执行一次</option>
                            <option value="10">10分钟执行一次</option>
                        </select>
                    </div>
                </div>
            </form>
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">api接口池</label></div>
            {#——————————————————加入分级树形——————————————————#}
{#            <div class="layui-btn-container">#}
{#                <button type="button" class="layui-btn layui-btn-sm" lay-demo="getChecked">获取选中节点数据</button>#}
{#                <button type="button" class="layui-btn layui-btn-sm" lay-demo="setChecked">全选</button>#}
{#                <button type="button" class="layui-btn layui-btn-sm" lay-demo="reload">取消勾选</button>#}
{#            </div>#}
            <div id="test12" class="demo-tree-more"></div>
            {#——————————————————上面代码是新加入的——————————————————————#}

            <div style="margin-top: 10px;margin-left: 300px">
                <input class="layui-btn layui-btn-danger" type="submit" value="保存"
                       style="margin-left:50px;margin-top:0px"></input>

                {#                        <span class="layui-btn" id="del_button" name="edit" onclick=task_save(this)>保存</span>#}
            </div>
        </div>
    </form>
    <script>
        {#——————————————————layui树形属性只能使用2.5以上版本，前面需要引用CDN进行更新——————————————————#}
        layui.use(['form', 'layedit', 'laydate', 'tree', 'util'], function () {
            var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , laydate = layui.laydate;
            form.val('exam', {
                frequency: {{ task_info[3] }}
            });
            {#树形使用#}
            var tree = layui.tree
                , layer = layui.layer
                , util = layui.util

                //获取数据分级
                , data = [{
                    title: '一级1'
                    , id: 1
                    , checked: true
                    , spread: true
                    , children: [{
                        title: '二级1-1 可允许跳转'
                        , id: 3
                        , href: 'https://www.layui.com/'
                        , children: [{
                            title: '三级1-1-3'
                            , id: 23
                            , children: [{
                                title: '四级1-1-3-1'
                                , id: 24
                                , children: [{
                                    title: '五级1-1-3-1-1'
                                    , id: 30
                                }, {
                                    title: '五级1-1-3-1-2'
                                    , id: 31
                                }]
                            }]
                        }, {
                            title: '三级1-1-1'
                            , id: 7
                            , children: [{
                                title: '四级1-1-1-1 可允许跳转'
                                , id: 15
                                , href: 'https://www.layui.com/doc/'
                            }]
                        }, {
                            title: '三级1-1-2'
                            , id: 8
                            , children: [{
                                title: '四级1-1-2-1'
                                , id: 32
                            }]
                        }]
                    }, {
                        title: '二级1-2'
                        , id: 4
                        , spread: true
                        , children: [{
                            title: '三级1-2-1'
                            , id: 9
                            , spread: true
                        }, {
                            title: '三级1-2-2'
                            , id: 10
                        }]
                    }, {
                        title: '二级1-3'
                        , id: 20
                        , children: [{
                            title: '三级1-3-1'
                            , id: 21
                        }, {
                            title: '三级1-3-2'
                            , id: 22
                        }]
                    }]
                }, {
                    title: '一级2'
                    , id: 2
                    , spread: true
                    , children: [{
                        title: '二级2-1'
                        , id: 5
                        , spread: true
                        , children: [{
                            title: '三级2-1-1'
                            , id: 11
                        }, {
                            title: '三级2-1-2'
                            , id: 12
                        }]
                    }, {
                        title: '二级2-2'
                        , id: 6
                        , children: [{
                            title: '三级2-2-1'
                            , id: 13
                        }, {
                            title: '三级2-2-2'
                            , id: 14
                            , disabled: true
                        }]
                    }]
                }, {
                    title: '一级3'
                    , id: 16
                    , children: [{
                        title: '二级3-1'
                        , id: 17
                        , fixed: true
                        , children: [{
                            title: '三级3-1-1'
                            , id: 18
                        }, {
                            title: '三级3-1-2'
                            , id: 19
                        }]
                    }, {
                        title: '二级3-2'
                        , id: 27
                        , children: [{
                            title: '三级3-2-1'
                            , id: 28
                        }, {
                            title: '三级3-2-2'
                            , id: 29
                        }]
                    }]
                }]

            //基本演示
            tree.render({
                elem: '#test12'
                , data: data
                , showCheckbox: true  //是否显示复选框
                , id: 'demoId1'
                , isJump: true //是否允许点击节点时弹出新窗口跳转
                , click: function (obj) {
                    var data = obj.data;  //获取当前点击的节点数据
                    layer.msg('状态：' + obj.state + '<br>节点数据：' + JSON.stringify(data));
                }
            });
        });
        //按钮事件
        {#util.event('lay-demo', {#}
        {#    getChecked: function (othis) {#}
        {#        var checkedData = tree.getChecked('demoId1'); //获取选中节点的数据#}
        {##}
        {#        layer.alert(JSON.stringify(checkedData), {shade: 0});#}
        {#        console.log(checkedData);#}
        {#    }#}
        {#    , setChecked: function () {#}
        {#        tree.setChecked('demoId1', [1, 2]); //勾选指定节点#}
        {#    }#}
        {#    , reload: function () {#}
        {#        //重新加载数据#}
        {#        tree.reload('demoId1', {});#}

    </script>

{% endblock right %}
<!-- 此模板现有部分，除页面名称外，其他均不可编辑 -->